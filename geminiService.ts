import { GoogleGenAI } from "@google/genai";
import type { AnimalData, YouTubeContentDualLang, VideoPromptsDualLang } from '../types';

// Initialize the Google Gemini API client.
// The API key is automatically sourced from the environment.
const ai = new GoogleGenAI({ apiKey: process.env.API_KEY });

async function callGemini<T>(prompt: string): Promise<T> {
  try {
    const response = await ai.models.generateContent({
      model: 'gemini-2.5-pro',
      contents: prompt,
    });
    
    let content = response.text;

    if (!content) {
        throw new Error("Invalid response structure from Gemini API: No content.");
    }
    
    // Clean the response: Some models wrap JSON in markdown code blocks.
    const jsonMatch = content.match(/```json\s*([\s\S]*?)\s*```/);
    if (jsonMatch && jsonMatch[1]) {
        content = jsonMatch[1];
    }
    
    return JSON.parse(content.trim()) as T;

  } catch (error) {
    console.error("Error communicating with Gemini API:", error);
    if (error instanceof SyntaxError) {
      console.error("Failed to parse JSON response from Gemini. The model may have returned an invalid format.", { response: error });
      throw new Error("Failed to parse the AI model's response. It might not be valid JSON.");
    }
    if (error instanceof Error) {
        throw error;
    }
    throw new Error('An unknown error occurred during the API call.');
  }
}

export async function generateUniqueAnimal(existingAnimals: string[]): Promise<AnimalData> {
    const existingAnimalsList = existingAnimals.length > 0 ? existingAnimals.join(', ') : '–ù–µ—Ç';
    
    const prompt = `–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–º –∏, –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –Ω–µ —Å–∞–º–æ–º –∏–∑–≤–µ—Å—Ç–Ω–æ–º –∂–∏–≤–æ—Ç–Ω–æ–º –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON.
    –°—Ç—Ä–µ–º–∏—Å—å –∫ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—é –≤ –∫–∞–∂–¥–æ–π –Ω–æ–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: –ø—Ä–µ–¥–ª–∞–≥–∞–π –∂–∏–≤–æ—Ç–Ω—ã—Ö —Ä–∞–∑–Ω—ã—Ö –≤–∏–¥–æ–≤ (–º–ª–µ–∫–æ–ø–∏—Ç–∞—é—â–∏–µ, –ø—Ç–∏—Ü—ã, —Ä—ã–±—ã, –Ω–∞—Å–µ–∫–æ–º—ã–µ, —Ä–µ–ø—Ç–∏–ª–∏–∏, –∞–º—Ñ–∏–±–∏–∏), –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤ –º–∏—Ä–∞.

    –ù–µ –ø–æ–≤—Ç–æ—Ä—è–π –∂–∏–≤–æ—Ç–Ω—ã—Ö –∏–∑ —ç—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞: ${existingAnimalsList}.

    JSON –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç—Ä–∏ –∫–ª—é—á–∞:
    1. "animalName": –ù–∞–∑–≤–∞–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –≤–∏–¥–∞/–ø–æ—Ä–æ–¥—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ú–∞–¥–∞–≥–∞—Å–∫–∞—Ä—Å–∫–∞—è —Ä—É–∫–æ–Ω–æ–∂–∫–∞ –ê–π-–∞–π").
    2. "russianArticle": –°—Ü–µ–Ω–∞—Ä–∏–π –¥–ª—è –≤–∏—Ä—É—Å–Ω–æ–≥–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ –≤–∏–¥–µ–æ (YouTube Shorts, Reels, TikTok) –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ (80-110 —Å–ª–æ–≤). –¢–µ–∫—Å—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞–ø–∏—Å–∞–Ω —Ç–∞–∫, —á—Ç–æ–±—ã –µ–≥–æ –±—ã–ª–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ —Å–ª—É—à–∞—Ç—å –∏ –æ–Ω —É–¥–µ—Ä–∂–∏–≤–∞–ª –≤–Ω–∏–º–∞–Ω–∏–µ –∑—Ä–∏—Ç–µ–ª—è –¥–æ –∫–æ–Ω—Ü–∞ (—Ü–µ–ª—å - retention > 80%).
        - **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è:**
            - **–ö—Ä—é–∫ (–ø–µ—Ä–≤—ã–µ 2-3 —Å–µ–∫—É–Ω–¥—ã):** –ù–∞—á–Ω–∏ —Å —à–æ–∫–∏—Ä—É—é—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ –∏–ª–∏ –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ–≥–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤–Ω–∏–º–∞–Ω–∏–µ. –ù–∞–ø—Ä–∏–º–µ—Ä: "–≠—Ç–æ –∂–∏–≤–æ—Ç–Ω–æ–µ —É–º–µ–µ—Ç –ª–µ—Ç–∞—Ç—å, —Ö–æ—Ç—è —É –Ω–µ–≥–æ –Ω–µ—Ç –∫—Ä—ã–ª—å–µ–≤!" –∏–ª–∏ "–í—ã –Ω–µ –ø–æ–≤–µ—Ä–∏—Ç–µ, —á—Ç–æ –µ—Å—Ç —ç—Ç–æ—Ç –º–∏–ª–∞—à–∫–∞!".
            - **–û—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å:** –†–∞—Å–∫—Ä–æ–π 3-4 —Å–∞–º—ã—Ö –ø–æ—Ä–∞–∑–∏—Ç–µ–ª—å–Ω—ã—Ö –∏ –º–∞–ª–æ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Ñ–∞–∫—Ç–∞. –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ—Ä–æ—Ç–∫–∏–µ, —ç–Ω–µ—Ä–≥–∏—á–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è. –ü–æ–≤–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –¥–∏–Ω–∞–º–∏—á–Ω—ã–º –∏ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–º.
            - **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:** –ó–∞–≤–µ—Ä—à–∏ –º–æ—â–Ω–æ–π —Ñ—Ä–∞–∑–æ–π –∏–ª–∏ –ø—Ä–∏–∑—ã–≤–æ–º, –∫–æ—Ç–æ—Ä—ã–π —Å—Ç–∏–º—É–ª–∏—Ä—É–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏. –ù–∞–ø—Ä–∏–º–µ—Ä: "–¢–µ–ø–µ—Ä—å –≤—ã –∑–Ω–∞–µ—Ç–µ –±–æ–ª—å—à–µ. –ö–∞–∫ –≤–∞–º —Ç–∞–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ?".
        - **–°—Ç–∏–ª—å:** –†–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–π, —ç–Ω–µ—Ä–≥–∏—á–Ω—ã–π, –∏–Ω—Ç—Ä–∏–≥—É—é—â–∏–π, –±—É–¥—Ç–æ –ª—É—á—à–∏–π –¥—Ä—É–≥ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç —á—Ç–æ-—Ç–æ –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ–µ.
    3. "englishArticle": –¢–æ—á–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥ —Ä—É—Å—Å–∫–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫, —Å–æ—Ö—Ä–∞–Ω—è—è —Ç–æ—Ç –∂–µ –≤–∏—Ä—É—Å–Ω—ã–π, —ç–Ω–µ—Ä–≥–∏—á–Ω—ã–π –∏ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–π —Å—Ç–∏–ª—å.
    
    –í–∞–∂–Ω–æ: —Ç–≤–æ–π –æ—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON-–æ–±—ä–µ–∫—Ç–∞, –±–µ–∑ –∫–∞–∫–∏—Ö-–ª–∏–±–æ –ø–æ—è—Å–Ω–µ–Ω–∏–π –∏–ª–∏ markdown-—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.`;

    return callGemini<AnimalData>(prompt);
}

export async function generateYouTubeContent(animalName: string, russianArticle: string, englishArticle: string): Promise<YouTubeContentDualLang> {
    const prompt = `–ù–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∂–∏–≤–æ—Ç–Ω–æ–º "${animalName}" –∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ (—Ä—É—Å—Å–∫–æ–π –∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–π –≤–µ—Ä—Å–∏–µ–π), —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è YouTube Shorts –Ω–∞ –î–í–£–• —è–∑—ã–∫–∞—Ö.

    –†—É—Å—Å–∫–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π: "${russianArticle}"
    –ê–Ω–≥–ª–∏–π—Å–∫–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π: "${englishArticle}"
    
    **–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞—Ç—å **–≤–∏—Ä—É—Å–Ω—ã–π, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫** –∏ **—Å—É–ø–µ—Ä-–≤–æ–≤–ª–µ–∫–∞—é—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ** –¥–ª—è –≤–∏–¥–µ–æ, —á—Ç–æ–±—ã –æ–Ω–æ –Ω–∞–±–∏—Ä–∞–ª–æ –º–∏–ª–ª–∏–æ–Ω—ã –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤.
    
    **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ó–∞–≥–æ–ª–æ–≤–∫—É (Title):**
    - –°–æ–∑–¥–∞–π –∑–∞–≥–æ–ª–æ–≤–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç –Ω–µ–ø—Ä–µ–æ–¥–æ–ª–∏–º–æ–µ –ª—é–±–æ–ø—ã—Ç—Å—Ç–≤–æ (—Å–æ–∑–¥–∞–µ—Ç "information gap").
    - –ò—Å–ø–æ–ª—å–∑—É–π —Å–∏–ª—å–Ω—ã–µ, —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞.
    - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–æ–±–∞–≤—å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π –∏ –ø–æ–ø—É–ª—è—Ä–Ω—ã–π —ç–º–æ–¥–∑–∏ –≤ –Ω–∞—á–∞–ª–µ –∏–ª–∏ –≤ –∫–æ–Ω—Ü–µ.
    - –ü—Ä–∏–º–µ—Ä—ã –≤–∏—Ä—É—Å–Ω—ã—Ö —Ñ–æ—Ä–º—É–ª: "–≠–¢–û –ñ–ò–í–û–¢–ù–û–ï –ù–ï –ò–ó –ù–ê–®–ï–ô –†–ï–ê–õ–¨–ù–û–°–¢–ò ü§Ø", "–í—ã –ù–ï –ø–æ–≤–µ—Ä–∏—Ç–µ, —á—Ç–æ —É–º–µ–µ—Ç –¥–µ–ª–∞—Ç—å —ç—Ç–æ—Ç –∑–≤–µ—Ä—å...", "–°–∞–º–æ–µ –°–¢–†–ê–ù–ù–û–ï —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–∞ –ó–µ–º–ª–µ?".
    
    **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –û–ø–∏—Å–∞–Ω–∏—é (Description):**
    - –ù–∞—á–Ω–∏ —Å –∏–Ω—Ç—Ä–∏–≥—É—é—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –∏–ª–∏ —É—Å–∏–ª–∏–≤–∞–µ—Ç –∏–¥–µ—é –∑–∞–≥–æ–ª–æ–≤–∫–∞.
    - –í 2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö –ø–µ—Ä–µ—Å–∫–∞–∂–∏ —Å—É—Ç—å –≤–∏–¥–µ–æ, –Ω–æ –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–π –≤—Å–µ—Ö –∫–∞—Ä—Ç, –æ—Å—Ç–∞–≤—å –∏–Ω—Ç—Ä–∏–≥—É.
    - –ó–∞–∫–æ–Ω—á–∏ –æ—Ç–∫—Ä—ã—Ç—ã–º –≤–æ–ø—Ä–æ—Å–æ–º –∫ –∞—É–¥–∏—Ç–æ—Ä–∏–∏, —á—Ç–æ–±—ã —Å–ø—Ä–æ–≤–æ—Ü–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ê –≤—ã –±—ã –∏—Å–ø—É–≥–∞–ª–∏—Å—å, –≤—Å—Ç—Ä–µ—Ç–∏–≤ –µ–≥–æ? üëá" –∏–ª–∏ "–ö–∞–∫–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —É–¥–∏–≤–∏–ª–∞ –≤–∞—Å –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ?").
    - –í –∫–æ–Ω—Ü–µ –¥–æ–±–∞–≤—å —Å–ø–∏—Å–æ–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ç–µ–≥–æ–≤ –¥–ª—è –ø–æ–∏—Å–∫–∞ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é, –±–µ–∑ #).
    
    –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON —Å –¥–≤—É–º—è –∫–ª—é—á–∞–º–∏ –≤–µ—Ä—Ö–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è: "ru" –∏ "en".
    –ö–∞–∂–¥—ã–π –∏–∑ —ç—Ç–∏—Ö –∫–ª—é—á–µ–π –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ–±—ä–µ–∫—Ç —Å –¥–≤—É–º—è –ø–æ–ª—è–º–∏:
    1. "title": —Å—Ç—Ä–æ–∫–∞ —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º —è–∑—ã–∫–µ.
    2. "description": —Å—Ç—Ä–æ–∫–∞ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º —è–∑—ã–∫–µ.
    
    –í–∞–∂–Ω–æ: —Ç–≤–æ–π –æ—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON-–æ–±—ä–µ–∫—Ç–∞, –±–µ–∑ –∫–∞–∫–∏—Ö-–ª–∏–±–æ –ø–æ—è—Å–Ω–µ–Ω–∏–π –∏–ª–∏ markdown-—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.`;

    return callGemini<YouTubeContentDualLang>(prompt);
}

export async function generateYouTubeTags(animalName: string, article: string): Promise<string> {
    const prompt = `–ù–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∂–∏–≤–æ—Ç–Ω–æ–º "${animalName}" –∏ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç–∞—Ç—å–∏: "${article}", —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π —Å–ø–∏—Å–æ–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –∏ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ç–µ–≥–æ–≤ –¥–ª—è YouTube Shorts –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ.
    
    **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
    - –¢–µ–≥–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –æ—Ö–≤–∞—Ç–∞ –∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è.
    - –í–∫–ª—é—á–∏ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–≥–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ shorts, ${animalName.replace(/\s+/g, '').toLowerCase()}, animalfacts, cuteanimals, wildlife.
    - –î–æ–±–∞–≤—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö —Ç–µ–≥–æ–≤, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ —Ñ–∞–∫—Ç–∞—Ö –∏–∑ —Å—Ç–∞—Ç—å–∏.
    - –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON —Å –æ–¥–Ω–∏–º –∫–ª—é—á–æ–º "tags", –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–≥–æ - –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ —Å —Ç–µ–≥–∞–º–∏, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã–º–∏ –∑–∞–ø—è—Ç—ã–º–∏, **–±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∏–º–≤–æ–ª–∞ #**.
    
    –í–∞–∂–Ω–æ: —Ç–≤–æ–π –æ—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON-–æ–±—ä–µ–∫—Ç–∞, –±–µ–∑ –∫–∞–∫–∏—Ö-–ª–∏–±–æ –ø–æ—è—Å–Ω–µ–Ω–∏–π –∏–ª–∏ markdown-—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.`;

    const result = await callGemini<{ tags: string }>(prompt);
    return result.tags;
}

export async function generateVideoPrompts(animalName: string, russianArticle: string, englishArticle: string): Promise<VideoPromptsDualLang> {
    const prompt = `–ù–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ç–µ–π –æ '${animalName}' (—Ä—É—Å—Å–∫–æ–π –∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–π –≤–µ—Ä—Å–∏–∏), —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π 14 –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∏ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ-–ø—Ä–æ–º—Ç–æ–≤ –¥–ª—è –º–æ–¥–µ–ª–∏ Veo 3.1 –Ω–∞ –î–í–£–• —è–∑—ã–∫–∞—Ö.

    –†—É—Å—Å–∫–∞—è —Å—Ç–∞—Ç—å—è: "${russianArticle}"
    –ê–Ω–≥–ª–∏–π—Å–∫–∞—è —Å—Ç–∞—Ç—å—è: "${englishArticle}"
    
    **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø—Ä–æ–º—Ç–∞–º:**
    - –î–ª—è –∫–∞–∂–¥–æ–≥–æ —è–∑—ã–∫–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 14 –ø—Ä–æ–º—Ç–æ–≤.
    - –ö–∞–∂–¥—ã–π –ø—Ä–æ–º—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ñ–∞–∫—Ç–∞–º, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º –≤ —Å—Ç–∞—Ç—å–µ, —Å–æ–∑–¥–∞–≤–∞—è –ª–æ–≥–∏—á–Ω—É—é –≤–∏–∑—É–∞–ª—å–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å.
    - –ü—Ä–æ–º—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞–ø–∏—Å–∞–Ω—ã –≤ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ, –≤–∫–ª—é—á–∞—è –¥–µ—Ç–∞–ª–∏ –æ —Å—Ü–µ–Ω–µ, –æ—Å–≤–µ—â–µ–Ω–∏–∏, —É–≥–ª–µ —Å—ä–µ–º–∫–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –∫–∞–º–µ—Ä—ã.
    - –ü—Ä–æ–º—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —è–∑—ã–∫–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ –≤–∏–¥–µ –Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ (1., 2., 3. –∏ —Ç.–¥.).
    - **–í–ê–ñ–ù–û:** –ö–∞–∂–¥—ã–π –Ω–µ—á–µ—Ç–Ω—ã–π –ø—Ä–æ–º—Ç (1, 3, 5...) –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å —Ç–∞–π–º–∫–æ–¥–∞ '[0:00-0:04] ', –∞ –∫–∞–∂–¥—ã–π —á–µ—Ç–Ω—ã–π –ø—Ä–æ–º—Ç (2, 4, 6...) –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å —Ç–∞–π–º–∫–æ–¥–∞ '[0:04-0:08] '.

    **–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞:**
    –ü—Ä–∏–º–µ—Ä 1: Hyperrealistic family video: two adult and one baby sugar gliders peeking out from a tree hollow entrance at sunset. The baby cautiously pokes its face out, looks around, then hides back behind an adult. Warm golden light beautifully illuminates their fur. Every gaze and fur texture are rendered with superb detail. Shot on Sony A1, 70-200mm f/2.8 GM II lens set at 150mm, f/3.5, ISO 1000. 8k, exceptional sharpness, touching moment.
    –ü—Ä–∏–º–µ—Ä 2: Photorealistic video of a sugar glider expertly balancing on a thin branch that slightly bends under its weight. It slowly moves along the branch, its paws gripping firmly, and its expressive eyes carefully watching the movement. Dynamic angle, focus on its gripping paws and expressive eyes. Natural, diffused jungle light at night. Shot on Canon EOS R3, 135mm f/2L lens, f/2.5, ISO 2000. 8k, professional quality, showcasing agility.

    –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–π –≤—ã–≤–æ–¥ –≤ –≤–∏–¥–µ JSON-–æ–±—ä–µ–∫—Ç–∞ —Å –¥–≤—É–º—è –∫–ª—é—á–∞–º–∏:
    1. 'ru_prompts': –∑–Ω–∞—á–µ–Ω–∏–µ ‚Äî –æ–¥–Ω–∞ –±–æ–ª—å—à–∞—è —Å—Ç—Ä–æ–∫–∞ (a single string), —Å–æ–¥–µ—Ä–∂–∞—â–∞—è 14 –ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ–º—Ç–æ–≤ –Ω–∞ —Ä—É—Å—Å–∫–æ–º. –ö–∞–∂–¥—ã–π –ø—Ä–æ–º—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–¥–µ–ª–µ–Ω –æ—Ç —Å–ª–µ–¥—É—é—â–µ–≥–æ –Ω–∞—Å—Ç–æ—è—â–∏–º —Å–∏–º–≤–æ–ª–æ–º –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏ (newline character, \\n).
    2. 'en_prompts': –∑–Ω–∞—á–µ–Ω–∏–µ ‚Äî –æ–¥–Ω–∞ –±–æ–ª—å—à–∞—è —Å—Ç—Ä–æ–∫–∞ (a single string), —Å–æ–¥–µ—Ä–∂–∞—â–∞—è 14 –ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ–º—Ç–æ–≤ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º. –ö–∞–∂–¥—ã–π –ø—Ä–æ–º—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–¥–µ–ª–µ–Ω –æ—Ç —Å–ª–µ–¥—É—é—â–µ–≥–æ –Ω–∞—Å—Ç–æ—è—â–∏–º —Å–∏–º–≤–æ–ª–æ–º –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏ (newline character, \\n).
    
    –í–∞–∂–Ω–æ: —Ç–≤–æ–π –æ—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON-–æ–±—ä–µ–∫—Ç–∞, –±–µ–∑ –∫–∞–∫–∏—Ö-–ª–∏–±–æ –ø–æ—è—Å–Ω–µ–Ω–∏–π –∏–ª–∏ markdown-—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.`;

    return callGemini<VideoPromptsDualLang>(prompt);
}